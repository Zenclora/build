#!/bin/bash

# VibeCoding AI Tools Installer script
# This script allows you to choose and install AI-powered coding tools.

set -e

GREEN='\033[0;32m'
NC='\033[0m'

# Function to install Cursor
install_cursor() {
    echo "--- Installing Cursor ---"
    echo "Downloading and adding Cursor GPG key..."
    curl -fsSL https://downloads.cursor.com/keys/anysphere.asc | gpg --dearmor | sudo tee /etc/apt/keyrings/cursor.gpg > /dev/null
    
    echo "Adding Cursor repository..."
    echo "deb [arch=amd64,arm64 signed-by=/etc/apt/keyrings/cursor.gpg] https://downloads.cursor.com/aptrepo stable main" | sudo tee /etc/apt/sources.list.d/cursor.list > /dev/null
    
    echo "Updating package lists and installing Cursor..."
    sudo apt update
    sudo apt install -y cursor
}

# Function to install Antigravity
install_antigravity() {
    echo "--- Installing Antigravity ---"
    sudo mkdir -p /etc/apt/keyrings
    echo "Downloading and adding Antigravity GPG key..."
    curl -fsSL https://us-central1-apt.pkg.dev/doc/repo-signing-key.gpg | \
      sudo gpg --dearmor --yes -o /etc/apt/keyrings/antigravity-repo-key.gpg
    
    echo "Adding Antigravity repository..."
    echo "deb [signed-by=/etc/apt/keyrings/antigravity-repo-key.gpg] https://us-central1-apt.pkg.dev/projects/antigravity-auto-updater-dev/ antigravity-debian main" | \
      sudo tee /etc/apt/sources.list.d/antigravity.list > /dev/null
    
    echo "Updating package lists and installing Antigravity..."
    sudo apt update
    sudo apt install -y antigravity
}

# Function to install Windsurf
install_windsurf() {
    echo "--- Installing Windsurf ---"
    echo "Installing dependencies..."
    sudo apt-get install -y wget gpg apt-transport-https
    
    echo "Downloading and adding Windsurf GPG key..."
    wget -qO- "https://windsurf-stable.codeiumdata.com/wVxQEIWkwPUEAGf3/windsurf.gpg" | gpg --dearmor > windsurf-stable.gpg
    sudo install -D -o root -g root -m 644 windsurf-stable.gpg /etc/apt/keyrings/windsurf-stable.gpg
    rm -f windsurf-stable.gpg
    
    echo "Adding Windsurf repository..."
    echo "deb [arch=amd64 signed-by=/etc/apt/keyrings/windsurf-stable.gpg] https://windsurf-stable.codeiumdata.com/wVxQEIWkwPUEAGf3/apt stable main" | sudo tee /etc/apt/sources.list.d/windsurf.list > /dev/null
    
    echo "Updating package lists and installing Windsurf..."
    sudo apt update
    sudo apt install -y windsurf
}

# Clear the screen for a better UX
clear
echo -e "${GREEN}==========================================${NC}"
echo -e "${GREEN}    VibeCoding AI Tools Installer         ${NC}"
echo -e "${GREEN}==========================================${NC}"
echo "Which AI-powered editor would you like to install?"
echo ""

options=("Cursor" "Windsurf" "Antigravity" "Install All" "Exit")
PS3="Please enter your choice (1-5): "

select opt in "${options[@]}"
do
    case $opt in
        "Cursor")
            install_cursor
            echo -e "${GREEN}Cursor installation finished!${NC}"
            break
            ;;
        "Windsurf")
            install_windsurf
            echo -e "${GREEN}Windsurf installation finished!${NC}"
            break
            ;;
        "Antigravity")
            install_antigravity
            echo -e "${GREEN}Antigravity installation finished!${NC}"
            break
            ;;
        "Install All")
            echo "Installing all VibeCoding tools..."
            install_cursor
            install_windsurf
            install_antigravity
            echo -e "${GREEN}All tools successfully installed!${NC}"
            break
            ;;
        "Exit")
            echo "Exiting..."
            exit 0
            ;;
        *) echo "Invalid option $REPLY. Please choose 1-5.";;
    esac
done
