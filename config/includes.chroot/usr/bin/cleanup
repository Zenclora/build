#!/bin/bash

# Zenclora System Cleanup Utility
# Cleans caches, logs, and temporary files to optimize performance.

# Check if running as root
if [ "$EUID" -ne 0 ]; then
  echo "Please run as root (sudo cleanup)"
  exit 1
fi

GREEN='\033[0;32m'
CYAN='\033[0;36m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo -e "${CYAN}==========================================${NC}"
echo -e "${CYAN}       Zenclora System Cleanup            ${NC}"
echo -e "${CYAN}==========================================${NC}"

# 1. Package Manager Cleanup
echo -e "${YELLOW}[1/5] Cleaning package manager cache...${NC}"
apt-get autoremove -y
apt-get autoclean -y
apt-get clean
echo -e "${GREEN}Done.${NC}"

# 2. Journal Logs Cleanup
echo -e "\n${YELLOW}[2/5] Cleaning system journal logs...${NC}"
# Keep only the last 2 days of logs or 100MB
journalctl --vacuum-time=2d || true
journalctl --vacuum-size=100M || true
echo -e "${GREEN}Done.${NC}"

# 3. Thumbnail Cache Cleanup
echo -e "\n${YELLOW}[3/5] Cleaning user thumbnail caches...${NC}"
rm -rf /home/*/.cache/thumbnails/* || true
rm -rf /root/.cache/thumbnails/* || true
echo -e "${GREEN}Done.${NC}"

# 4. Temporary Files
echo -e "\n${YELLOW}[4/5] Cleaning temporary files...${NC}"
rm -rf /tmp/* || true
rm -rf /var/tmp/* || true
echo -e "${GREEN}Done.${NC}"

# 5. Pagecache / Swap (Soft maintenance)
echo -e "\n${YELLOW}[5/5] Refreshing system memory...${NC}"
sync
# Only clear pagecache (1) to avoid performance hits on active apps
echo 1 > /proc/sys/vm/drop_caches
echo -e "${GREEN}Done.${NC}"

echo -e "\n${CYAN}==========================================${NC}"
echo -e "${GREEN}      System Cleaned Successfully!        ${NC}"
echo -e "${CYAN}==========================================${NC}"
